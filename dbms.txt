create table Actor78
(
act_id int primary key,
act_name varchar(20),
act_gender varchar(10) 
);

    ACT_ID ACT_NAME             ACT_GENDER
---------- -------------------- ----------
       301 anushka              f
       302 prabhas              m
       303 punith               m
       304 jermy                m


create table Director78
(
dir_id int primary key,
dir_name varchar(20),
dir_phone int 
);
    DIR_ID DIR_NAME              DIR_PHONE
---------- -------------------- ----------
        60 rajamouli            8151611001
        61 hitchock             7766138911
        62 rajamouli            9986776531
        63 steven speilberg     8989776538


create table Movies78
(
mov_id int primary key,
mov_title varchar(20),
mov_year int,
mov_lang varchar(15),
dir_id references Director78(dir_id) on delete cascade
);

    MOV_ID MOV_TITLE              MOV_YEAR MOV_LANG            DIR_ID
---------- -------------------- ---------- --------------- ----------
      1001 bhahubali_2                2017 telugu                  60
      1002 bhahubali_1                2015 telugu                  60
      1003 akash                      2008 kannada                 61
      1004 warhorse                   2011 english                 63


create table MovieCast78
(
act_id references Actor78(act_id) on delete cascade,
mov_id references Movies78(mov_id) on delete cascade,
role varchar(20),
primary key(act_id,mov_id)
);

    ACT_ID     MOV_ID ROLE
---------- ---------- --------------------
       301       1002 heroine
       301       1001 heroine
       303       1003 hero
       303       1002 guest
       304       1004 hero


create table Rating78(
mov_id references Movies78(mov_id) on delete cascade,
rev_starts int,
primary key(mov_id)
);


    MOV_ID REV_STARTS
---------- ----------
      1001          4
      1002          2
      1003          5
      1004          4
__________________________________________________________________________

insert into Actor78 values(301,'anushka','f');
insert into Actor78 values(302,'prabhas','m');
insert into Actor78 values(303,'punith','m');
insert into Actor78 values(304,'jermy','m');

select * from  Actor78;

insert into Director78 values(60,'rajamouli','8151611001');
insert into Director78 values(61,'hitchock','7766138911');
insert into Director78 values(62,'rajamouli','9986776531');
insert into Director78 values(63,'steven speilberg','8989776538');

select * from  Director78;

insert into Movies78 values(1001,'bhahubali_2',2017,'telugu',60);
insert into Movies78 values(1002,'bhahubali_1',2015,'telugu',60);
insert into Movies78 values(1003,'akash',2008,'kannada',61);
insert into Movies78 values(1004,'warhorse',2011,'english',63);

select * from  Movies78;

insert into MoviesCast78 values(301,1002,'heroine');
insert into MoviesCast78 values(301,1001,'heroine');
insert into MoviesCast78 values(303,1003,'hero');
insert into MoviesCast78 values(303,1002,'guest');
insert into MoviesCast78 values(304,1004,'hero');


select * from  MovieCast78;

insert into Rating78 values(1001,4);
insert into Rating78 values(1002,2);
insert into Rating78 values(1003,5);
insert into Rating78 values(1004,4);


select * from  Rating78;

select movtitle from Movies78 where dirid in
(select dirid from Director78 where
dirname='Hitchcock');

MOV_TITLE
--------------------
akash


select movtitle from Movies78 m,Movies78 mv 
where m.movid=mv.movid and actid in
(select actid from MovieCast78 group by actid
having count(actid)>1)
group by movtitle having count(*)>1;

MOV_TITLE
---------------
bhahubali_1


select a.actname,c.movtitle,c.movyear
from Actor78 a,MovieCast78 b,Movies78 c
where a.actid=b.actid
and b.movid=c.movid
and c.movyear not between 2000 and 2015;

ACT_NAME             MOV_TITLE              MOV_YEAR
-------------------- -------------------- ----------
anushka              bhahubali_2                2017

update rating_p52 set rev_starts=5
where mov_id in (select mov_id from movies_p52
where dir_id in(select dir_id
from director_p52
where dir_name='steven speilberg'));


    MOV_ID REV_STARTS
---------- ----------
      1001          4
      1002          2
      1003          5
      1004          5














CREATE TABLE STUDENT78 (
USN VARCHAR (10) PRIMARY KEY,
SNAME VARCHAR (25),
ADDRESS VARCHAR (25),
PHONE NUMBER (10),
GENDER CHAR (1));

CREATE TABLE SEMSEC78 (
SSID VARCHAR (5) PRIMARY KEY,
SEM NUMBER (2),
SEC CHAR (1));

CREATE TABLE CLASS78 (
USN VARCHAR (10),
SSID VARCHAR (5),
PRIMARY KEY (USN, SSID),
FOREIGN KEY (USN) REFERENCES STUDENT78 (USN),
FOREIGN KEY (SSID) REFERENCES SEMSEC78 (SSID));

CREATE TABLE SUBJECT78 (
SUBCODE VARCHAR (8),
TITLE VARCHAR (20),
SEM NUMBER (2),
CREDITS NUMBER (2),
PRIMARY KEY (SUBCODE));

CREATE TABLE IAMARKS78 (
USN VARCHAR (10),
SUBCODE VARCHAR (8),
SSID VARCHAR (5),
TEST1 NUMBER (2),
TEST2 NUMBER (2),
TEST3 NUMBER (2),
FINALIA NUMBER (2),
PRIMARY KEY (USN, SUBCODE, SSID),
FOREIGN KEY (USN) REFERENCES STUDENT78 (USN),
FOREIGN KEY (SUBCODE) REFERENCES SUBJECT78 (SUBCODE),
FOREIGN KEY (SSID) REFERENCES SEMSEC78 (SSID));


INSERT INTO STUDENT78 VALUES ('1JS13IS020','AKSHAY','BELAGAVI',
8877881122,'M');
INSERT INTO STUDENT78 VALUES ('1JS13IS062','SANDHYA','BENGALURU',
7722829912,'F');
INSERT INTO STUDENT78 VALUES ('1JS13IS091','TEESHA','BENGALURU',
7712312312,'F');
INSERT INTO STUDENT78 VALUES ('1JS13IS066','SUPRIYA','MANGALURU',
8877881122,'F');
INSERT INTO STUDENT78 VALUES ('1JS14IS010','ABHAY','BENGALURU',
9900211201,'M');
INSERT INTO STUDENT78 VALUES ('1JS14IS032','BHASKAR','BENGALURU',
9923211099,'M');
INSERT INTO STUDENT78 VALUES ('1JS14IS025','ASMI','BENGALURU', 7894737377,'F');
INSERT INTO STUDENT78 VALUES ('1JS15IS011','AJAY','TUMKUR', 9845091341,'M');
INSERT INTO STUDENT78 VALUES ('1JS15IS029','CHITRA','DAVANGERE',
7696772121,'F');
INSERT INTO STUDENT78 VALUES ('1JS15IS045','JEEVA','BELLARY', 9944850121,'M');
INSERT INTO STUDENT78 VALUES ('1JS15IS091','SANTOSH','MANGALURU',
8812332201,'M');
INSERT INTO STUDENT78 VALUES ('1JS16IS045','ISMAIL','KALBURGI',
9900232201,'M');
INSERT INTO STUDENT78 VALUES ('1JS16IS088','SAMEERA','SHIMOGA',
9905542212,'F');
INSERT INTO STUDENT78 VALUES ('1JS16IS122','VINAYAKA','CHIKAMAGALUR',
8800880011,'M');



INSERT INTO SEMSEC78 VALUES ('ISE8A', 8,'A');
INSERT INTO SEMSEC78 VALUES ('ISE8B', 8,'B');
INSERT INTO SEMSEC78 VALUES ('ISE8C', 8,'C');
INSERT INTO SEMSEC78 VALUES ('ISE7A', 7,'A');
INSERT INTO SEMSEC78 VALUES ('ISE7B', 7,'B');
INSERT INTO SEMSEC78 VALUES ('ISE7C', 7,'C');
INSERT INTO SEMSEC78 VALUES ('ISE6A', 6,'A');
INSERT INTO SEMSEC78 VALUES ('ISE6B', 6,'B');
INSERT INTO SEMSEC78 VALUES ('ISE6C', 6,'C');
INSERT INTO SEMSEC78 VALUES ('ISE5A', 5,'A');
INSERT INTO SEMSEC78 VALUES ('ISE5B', 5,'B');
INSERT INTO SEMSEC78 VALUES ('ISE5C', 5,'C');
INSERT INTO SEMSEC78 VALUES ('ISE4A', 4,'A');
INSERT INTO SEMSEC78 VALUES ('ISE4B', 4,'B');
INSERT INTO SEMSEC78 VALUES ('ISE4C', 4,'C');
INSERT INTO SEMSEC78 VALUES ('ISE3A', 3,'A');
INSERT INTO SEMSEC78 VALUES ('ISE3B', 3,'B');
INSERT INTO SEMSEC78 VALUES ('ISE3C', 3,'C');
INSERT INTO SEMSEC78 VALUES ('ISE2A', 2,'A');
INSERT INTO SEMSEC78 VALUES ('ISE2B', 2,'B');
INSERT INTO SEMSEC78 VALUES ('ISE2C', 2,'C');
INSERT INTO SEMSEC78 VALUES ('ISE1A', 1,'A');
INSERT INTO SEMSEC78 VALUES ('ISE1B', 1,'B');
INSERT INTO SEMSEC78 VALUES ('ISE1C', 1,'C');


INSERT INTO CLASS78 VALUES ('1JS13IS020','ISE8A');
INSERT INTO CLASS78 VALUES ('1JS13IS062','ISE8A');
INSERT INTO CLASS78 VALUES ('1JS13IS066','ISE8B');
INSERT INTO CLASS78 VALUES ('1JS13IS091','ISE8C');
INSERT INTO CLASS78 VALUES ('1JS14IS010','ISE7A');
INSERT INTO CLASS78 VALUES ('1JS14IS025','ISE7A');
INSERT INTO CLASS78 VALUES ('1JS14IS032','ISE7A');
INSERT INTO CLASS78 VALUES ('1JS15IS011','ISE4A');
INSERT INTO CLASS78 VALUES ('1JS15IS029','ISE4A');
INSERT INTO CLASS78 VALUES ('1JS15IS045','ISE4B');
INSERT INTO CLASS78 VALUES ('1JS15IS091','ISE4C');
INSERT INTO CLASS78 VALUES ('1JS16IS045','ISE3A');
INSERT INTO CLASS78 VALUES ('1JS16IS088','ISE3B');
INSERT INTO CLASS78 VALUES ('1JS16IS122','ISE3C');


INSERT INTO SUBJECT78 VALUES ('10IS81','ACA', 8, 4);
INSERT INTO SUBJECT78 VALUES ('10IS82','SSM', 8, 4);
INSERT INTO SUBJECT78 VALUES ('10IS83','NM', 8, 4);
INSERT INTO SUBJECT78 VALUES ('10IS84','CC', 8, 4);
INSERT INTO SUBJECT78 VALUES ('10IS85','PW', 8, 4);
INSERT INTO SUBJECT78 VALUES ('10IS71','OOAD', 7, 4);
INSERT INTO SUBJECT78 VALUES ('10IS72','EIS', 7, 4);
INSERT INTO SUBJECT78 VALUES ('10IS73','PTW', 7, 4);
INSERT INTO SUBJECT78 VALUES ('10IS74','DWDM', 7, 4);
INSERT INTO SUBJECT78 VALUES ('10IS75','JAVA', 7, 4);
INSERT INTO SUBJECT78 VALUES ('10IS76','SAN', 7, 4);
INSERT INTO SUBJECT78 VALUES ('15IS51', 'ME', 5, 4);
INSERT INTO SUBJECT78 VALUES ('15IS52','CN', 5, 4);
INSERT INTO SUBJECT78 VALUES ('15IS53','DBMS', 5, 4);
INSERT INTO SUBJECT78 VALUES ('15IS54','ATC', 5, 4);
INSERT INTO SUBJECT78 VALUES ('15IS55','JAVA', 5, 3);
INSERT INTO SUBJECT78 VALUES ('15IS56','AI', 5, 3);
INSERT INTO SUBJECT78 VALUES ('15IS41','M4', 4, 4);
INSERT INTO SUBJECT78 VALUES ('15IS42','SE', 4, 4);
INSERT INTO SUBJECT78 VALUES ('15IS43','DAA', 4, 4);
INSERT INTO SUBJECT78 VALUES ('15IS44','MPMC', 4, 4);
INSERT INTO SUBJECT78 VALUES ('15IS45','OOC', 4, 3);
INSERT INTO SUBJECT78 VALUES ('15IS46','DC', 4, 3);
INSERT INTO SUBJECT78 VALUES ('15IS31','M3', 3, 4);
INSERT INTO SUBJECT78 VALUES ('15IS32','ADE', 3, 4);
INSERT INTO SUBJECT78 VALUES ('15IS33','DSA', 3, 4);
INSERT INTO SUBJECT78 VALUES ('15IS34','CO', 3, 4);
INSERT INTO SUBJECT78 VALUES ('15IS35','USP', 3, 3);
INSERT INTO SUBJECT78 VALUES ('15IS36','DMS', 3, 3);



INSERT INTO IAMARKS78 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES
('1JS13IS091','10IS81','ISE8C', 15, 16, 18);
INSERT INTO IAMARKS78 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES
('1JS13IS091','10IS82','ISE8C', 12, 19, 14);
INSERT INTO IAMARKS78 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES
('1JS13IS091','10IS83','ISE8C', 19, 15, 20);
INSERT INTO IAMARKS78 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES
('1JS13IS091','10IS84','ISE8C', 20, 16, 19);
INSERT INTO IAMARKS78 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES
('1JS13IS091','10IS85','ISE8C', 15, 15, 12);

SELECT * FROM STUDENT78;
SELECT * FROM SEMSEC78;
SELECT * FROM CLASS78;
SELECT * FROM SUBJECT78;
SELECT * FROM IAMARKS78;

SELECT S.*, SS.SEM, SS.SEC
FROM STUDENT78 S, SEMSEC78 SS, CLASS78 C
WHERE S.USN=C.USN AND 
SS.SSID=C.SSID
AND SS.SEM=4 AND
SS.SEC='C';

SELECT SS.SEM, SS.SEC, S.GENDER, COUNT(S.GENDER) AS 
COUNT FROM STUDENT78 S, SEMSEC78 SS, CLASS78 C WHERE 
S.USN=C.USN AND
SS.SSID=C.SSID
GROUP BY SS.SEM, SS.SEC, S.GENDER
ORDER BY SEM;

CREATE VIEW STUMARKS78 AS
SELECT SUBCODE,TEST1
FROM IAMARKS78
WHERE USN='1JS13IS091';
SELECT * FROM STUMARKS78;

SELECT S.USN, S.NAME, S.ADDRESS, S.PHONE, S.GENDER
(CASE
WHEN IA.FINALIA BETWEEN 17 AND 20 THEN
'OUTSTANDING' WHEN IA.FINALIA BETWEEN 12 AND 16
THEN 'AVERAGE' ELSE 'WEAK'
END) AS CAT
FROM STUDENT78 S, SEMSEC78 SS, IAMARKS78 IA, SUBJECT78 SUB
WHERE S.USN=IA.USN AND 
SS.SSID=IA.SSID AND
SUB.SUBCODE=IA.SUBCODE AND
SUB.SEM=8;




CREATE OR REPLACE PROCEDURE AVGMARKS
IS
CURSOR C_IAMARKS IS
SELECT GREATEST(TEST1,TEST2) AS A, GREATEST(TEST1,TEST3) AS B,
GREATEST(TEST3,TEST2) AS C
FROM IAMARKS78
WHERE FINALIA IS NULL
FOR UPDATE;
 C_A NUMBER;
 C_B NUMBER;
 C_C NUMBER;
 C_SM NUMBER;
 C_AV NUMBER;
BEGIN
 OPEN C_IAMARKS;
 LOOP
 FETCH C_IAMARKS INTO C_A, C_B, C_C;
 EXIT WHEN C_IAMARKS%NOTFOUND;
 --DBMS_OUTPUT.PUT_LINE(C_A || ' ' || C_B || ' ' || C_C);
 IF (C_A != C_B) THEN
C_SM:=C_A+C_B;
 ELSE
C_SM:=C_A+C_C;
END IF;
 C_AV:=C_SM/2;
 --DBMS_OUTPUT.PUT_LINE('SUM = '||C_SM);
 --DBMS_OUTPUT.PUT_LINE('AVERAGE = '||C_AV);
 UPDATE IAMARKS78 SET FINALIA=C_AV WHERE CURRENT OF C_IAMARKS;
 END LOOP;
 CLOSE C_IAMARKS;
END;
/

BEGIN
AVGMARKS;
END;
/


SELECT S.USN,S.SNAME,S.ADDRESS,S.PHONE,S.GENDER,
 (CASE
 WHEN IA.FINALIA BETWEEN 17 AND 20 THEN 'OUTSTANDING'
 WHEN IA.FINALIA BETWEEN 12 AND 16 THEN 'AVERAGE'
 ELSE 'WEAK'
 END) AS CAT
FROM STUDENT78 S, SEMSEC78 SS, IAMARKS78 IA, SUBJECT78 SUB
WHERE S.USN = IA.USN AND
SS.SSID = IA.SSID AND
SUB.SUBCODE = IA.SUBCODE AND
SUB.SEM = 8;

















CREATE TABLE DEPARTMENT78
(DNO VARCHAR2 (20) PRIMARY KEY,
DNAME VARCHAR2 (20),
MGRSTARTDATE DATE);


CREATE TABLE EMPLOYEE78
(SSN VARCHAR2 (20) PRIMARY KEY,
FNAME VARCHAR2 (20),
LNAME VARCHAR2 (20),
ADDRESS VARCHAR2 (20),
SEX CHAR (1),
SALARY INTEGER,
SUPERSSN REFERENCES EMPLOYEE78 (SSN),
DNO REFERENCES DEPARTMENT78 (DNO));

ALTER TABLE DEPARTMENT78
ADD MGRSSN REFERENCES EMPLOYEE78 (SSN);

CREATE TABLE DLOCATION78
(DLOC VARCHAR2 (20),
DNO REFERENCES DEPARTMENT78 (DNO),
PRIMARY KEY (DNO, DLOC));

CREATE TABLE PROJECT78
(PNO INTEGER PRIMARY KEY,
PNAME VARCHAR2 (20),
PLOCATION VARCHAR2 (20),
DNO REFERENCES DEPARTMENT78 (DNO));

CREATE TABLE WORKS_ON78
(HOURS NUMBER (2),
SSN REFERENCES EMPLOYEE78 (SSN),
PNO REFERENCES PROJECT78(PNO),
PRIMARY KEY (SSN, PNO));



INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSECE01','JOHN','SCOTT','BANGALORE','M', 450000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE01','JAMES','SMITH','BANGALORE','M', 500000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE02','HEARN','BAKER','BANGALORE','M', 700000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE03','EDWARD','SCOTT','MYSORE','M', 500000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE04','PAVAN','HEGDE','MANGALORE','M', 650000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE05','GIRISH','MALYA','MYSORE','M', 450000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSCSE06','NEHA','SN','BANGALORE','F', 800000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSACC01','AHANA','K','MANGALORE','F', 350000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSACC02','SANTHOSH','KUMAR','MANGALORE','M', 300000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSISE01','VEENA','M','MYSORE','M', 600000);
INSERT INTO EMPLOYEE78 (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
('JSSIT01','NAGESH','HR','BANGALORE','M', 500000);


INSERT INTO DEPARTMENT78 VALUES ('1','ACCOUNTS','01-JAN-01','JSSACC02');
INSERT INTO DEPARTMENT78 VALUES ('2','IT','01-AUG-16','JSSIT01');
INSERT INTO DEPARTMENT78 VALUES ('3','ECE','01-JUN-08','JSSECE01');
INSERT INTO DEPARTMENT78 VALUES ('4','ISE','01-AUG-15','JSSISE01');
INSERT INTO DEPARTMENT78 VALUES ('5','CSE','01-JUN-02','JSSCSE05');

UPDATE EMPLOYEE78 SET
SUPERSSN=NULL, DNO='3'
WHERE SSN='JSSECE01';
UPDATE EMPLOYEE78 SET
SUPERSSN='JSSCSE02', DNO='5'
WHERE SSN='JSSCSE01';
UPDATE EMPLOYEE78 SET
SUPERSSN='JSSCSE03', DNO='5'
WHERE SSN='JSSCSE02';
UPDATE EMPLOYEE78 SET
SUPERSSN='JSSCSE04', DNO='5'
WHERE SSN='JSSCSE03';
UPDATE EMPLOYEE78 SET
DNO='5', SUPERSSN='JSSCSE05'
WHERE SSN='JSSCSE04';
UPDATE EMPLOYEE78 SET
DNO='5', SUPERSSN='JSSCSE06'
WHERE SSN='JSSCSE05';
UPDATE EMPLOYEE78 SET
DNO='5', SUPERSSN=NULL
WHERE SSN='JSSCSE06';
UPDATE EMPLOYEE78 SET
DNO='1', SUPERSSN='JSSACC02'
WHERE SSN='JSSACC01';
UPDATE EMPLOYEE78 SET
DNO='1', SUPERSSN=NULL
WHERE SSN='JSSACC02';
UPDATE EMPLOYEE78 SET
DNO='4', SUPERSSN=NULL
WHERE SSN='JSSISE01';
UPDATE EMPLOYEE78 SET
DNO='2', SUPERSSN=NULL
WHERE SSN='JSSIT01';


INSERT INTO DLOCATION78 VALUES ('BANGALORE', '1');
INSERT INTO DLOCATION78 VALUES ('BANGALORE', '2');
INSERT INTO DLOCATION78 VALUES ('BANGALORE', '3');
INSERT INTO DLOCATION78 VALUES ('MANGALORE', '4');
INSERT INTO DLOCATION78 VALUES ('MANGALORE', '5');

INSERT INTO PROJECT78 VALUES (100,'IOT','BANGALORE','5');
INSERT INTO PROJECT78 VALUES (101,'CLOUD','BANGALORE','5');
INSERT INTO PROJECT78 VALUES (102,'BIGDATA','BANGALORE','5');
INSERT INTO PROJECT78 VALUES (103,'SENSORS','BANGALORE','3');
INSERT INTO PROJECT78 VALUES (104,'BANK MANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT78 VALUES (105,'SALARY MANAGEMENT','BANGALORE','1');
INSERT INTO PROJECT78 VALUES (106,'OPENSTACK','BANGALORE','4');
INSERT INTO PROJECT78 VALUES (107,'SMART CITY','BANGALORE','2');

INSERT INTO WORKS_ON78 VALUES (4, 'JSSCSE01', 100);
INSERT INTO WORKS_ON78 VALUES (6, 'JSSCSE01', 101);
INSERT INTO WORKS_ON78 VALUES (8, 'JSSCSE01', 102);
INSERT INTO WORKS_ON78 VALUES (10,'JSSCSE02', 100);
INSERT INTO WORKS_ON78 VALUES (3, 'JSSCSE04', 100);
INSERT INTO WORKS_ON78 VALUES (4, 'JSSCSE05', 101);
INSERT INTO WORKS_ON78 VALUES (5, 'JSSCSE06', 102);
INSERT INTO WORKS_ON78 VALUES (6, 'JSSCSE03', 102);
INSERT INTO WORKS_ON78 VALUES (7, 'JSSECE01', 103);
INSERT INTO WORKS_ON78 VALUES (5, 'JSSACC01', 104);
INSERT INTO WORKS_ON78 VALUES (6, 'JSSACC02', 105);
INSERT INTO WORKS_ON78 VALUES (4, 'JSSISE01', 106);
INSERT INTO WORKS_ON78 VALUES (10, 'JSSIT01', 107);



(SELECT DISTINCT P.PNO
FROM PROJECT78 P, DEPARTMENT78 D, EMPLOYEE78 E
WHERE E.DNO=D.DNO
AND D.MGRSSN=E.SSN
AND E.LNAME='SCOTT')
UNION
(SELECT DISTINCT P1.PNO
FROM PROJECT78 P1, WORKS_ON78 W, EMPLOYEE78 E1
WHERE P1.PNO=W.PNO
AND E1.SSN=W.SSN
AND E1.LNAME='SCOTT');

SELECT E.FNAME, E.LNAME, 1.1*E.SALARY AS INCR_SAL
FROM EMPLOYEE78 E, WORKS_ON78 W, PROJECT78 P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME='IOT';

SELECT SUM (E.SALARY), MAX (E.SALARY), MIN (E.SALARY), AVG
(E.SALARY)
FROM EMPLOYEE78 E, DEPARTMENT78 D
WHERE E.DNO=D.DNO
AND D.DNAME='ACCOUNTS';


SELECT E.FNAME, E.LNAME
FROM EMPLOYEE78 E
WHERE NOT EXISTS((SELECT PNO
FROM PROJECT78
WHERE DNO='5')
MINUS (SELECT PNO
FROM WORKS_ON78
WHERE E.SSN=SSN));

SELECT D.DNO, COUNT (*)
FROM DEPARTMENT78 D, EMPLOYEE78 E
WHERE D.DNO=E.DNO
AND E.SALARY>600000
AND D.DNO IN (SELECT E1.DNO
FROM EMPLOYEE78 E1
GROUP BY E1.DNO
HAVING COUNT (*)>5)
GROUP BY D.DNO;









 

